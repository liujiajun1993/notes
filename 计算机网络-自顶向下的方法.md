## 一、概论
1. 交换式网络
  - 电路交换网络
  - 分组交换网络

2. 协议分层
  - 优点：将服务从实现中分离出来。例如如果需要修改或更换应用层协议，只需要修改相应的应用层设备即可

3. TCP/IP协议簇
   ![](https://raw.githubusercontent.com/liujiajun1993/notes/master/images/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C1-1.png)
   主机间通信方法, 注意交换机和路由器的区别。路由器涉及多个数据链路层和物理层的结合，因此需要更高一层的网络层。![主机间通信方法](https://raw.githubusercontent.com/liujiajun1993/notes/master/images/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C1-2.png)
   应用层、传输层、网络层属于端对端（end-to-end），而数据链路层和物理层属于点对点（hop-to-hop），必须经过一个主机或者一个路由器一步一步传递。
   1. 应用层，进程之间的通信，HTTP/SMTP/FTP/TELNET/SSH/DNS...
   2. 传输层，向应用层提供服务，将应用层信息投递到目标主机。TCP/UDP/SCTP(流控制传输协议)
   3. 网络层，在院计算机和目标计算机之间创建一个连接。IP/DHCP/ARP（地址解析协议）/ICMP（因特网控制报文协议）/IGMP（因特网组管理协议）
   4. 数据链路层，将数据包封装在frame（帧）中
   5. 物理层。携带frame中的bit穿过链路

4. 封装和解封装
  应用层message -> 传输层segment(TCP)/user datagram(UDP) -> 网络层(datagram, 添加自己的头部) -> 数据链路层(frame, 添加自己的头部) -> 物理层
   
5. 地址
  每一层协议（除了物理层）都需要地址来对应通信的双方。
  传输层的地址对应端口号，网络层地址对应网络IP，链路层地址对应MAC地址。链路层地址用于在网络中定义一个特定的主机或者路由器。

6. OSI模型（注意是模型不是协议）
  <img src="https://raw.githubusercontent.com/liujiajun1993/notes/master/images/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C1-3.png" width="350px">
  相对于TCP/IP协议簇，多了会话层和表示层，一般认为TCP/IP的应用层包含了它们
  OSI模型最终并没有替代TCP/IP协议簇
  
----------
## 二、应用层
  TCP/IP协议簇的层次结构是的因特网比其他网络诸如电话网络、广播网络更灵活，只需要加入新的协议就可以支持新的服务。

### 2.1 客户-服务器模式
   应用层与操作系统（操作系统封装了之后的四层接口）的通信通过API接口实现。包括套接字接口（socket），传输层接口（Transport Layer Interface, TLI)以及STREAM。
   套接字地址 = IP地址 + 端口号
   
   **URI** = 协议 + 主机 + 端口 + 路径
   
   <strong style="color: #f00">万维网</strong>是无数个网络站点和网页的集合，它们在一起构成了<strong style="color:#f00">因特网</strong>最主要的部分（因特网也包括电子邮件、Usenet以及新闻组）。它实际上是多媒体的集合，是由<strong style="color:#0f0">超级链接 (hyper)</strong>连接而成的。
   
   <strong style="color: #f00">超文本传输协议(HTTP)</strong>定义客户服务器如何从万维网获取网页的协议。使用TCP服务，在客户和服务器进行任何事务之前，必须建立连接。
   
   **持续连接**一次TCP连接可以响应多次请求
   
   **HTTP请求报文**
   ![请求报文和响应报文格式](https://raw.githubusercontent.com/liujiajun1993/notes/master/images/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C1-4.png)
   ![请求头部](https://raw.githubusercontent.com/liujiajun1993/notes/master/images/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C1-5.png)
   ![响应头部](https://raw.githubusercontent.com/liujiajun1993/notes/master/images/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C1-6.png)
   
   **请求条件**缓存的四种条件，参考[浏览器缓存知识小结及应用](http://www.cnblogs.com/lyzg/p/5125934.html)或印象笔记中的剪藏：
   - Expires，对比时间
   - Cache-Control,设置max-age=毫秒数
   - Last-Modified/If-Modified-Since
   - Etag/If-None-Match
  

   **Cookie**
   
   **代理服务器**代理服务器是一台计算机，能够保存最近请求的响应副本。如果没有命中缓存，就向响应的服务器发送请求。
   代理服务器既是一个服务器又是一个客户。
   
   **HTTP安全**HTTPS提供保密性、客户和服务器鉴别，以及数据完整性保证。
   
   <strong style="color: #f00">FTP</strong>更适用于传输大文件或者使用不同格式传送文件。
   ![FTP传输过程](https://raw.githubusercontent.com/liujiajun1993/notes/master/images/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C1-7.png)
   注意FTP的控制进程和数据传输进程是**分开的**。*21端口*用于控制链接，*20端口*用于数据连接。整个FTP会话过程中，控制连接始终处于连接状态，当文件传输命令执行时，数据连接就打开，传输完毕就关闭。
   FTP的数据传输进程略。
   安全的FTP建立在SSL层上，成为SSL-FTP。
   
   <strong style="color: #f00">SMTP</strong>定义MTA客户机和服务器之间的常用协议。
   ![邮件发送过程](https://raw.githubusercontent.com/liujiajun1993/notes/master/images/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C1-8.png)
   邮件传输过程：连接建立（服务器返回代码220->客户发送HELO报文->服务器返回250）、邮件传输、连接终止（服务器返回221）
   
   <strong style="color: #f00">POP/IMAP</strong>SMTP定义发送邮件(push)的协议，pull阶段使用报文访问代理协议，一般有两种，分别为POP3和IMAP4。
   相对而言，IMAP4更复杂，但功能更多。
   
   <strong style="color: #f00">MIME</strong>
   
### 2.2 对等模式（P2P模式）
   不需要一个不断运行并等待客户进程连接的服务器进程。（迅雷。。。）

  
